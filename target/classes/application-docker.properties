# Docker-specific configuration to fix cgroup metrics issue

# Disable problematic metrics
management.metrics.enable.process.cpu=false
management.metrics.enable.system.cpu=false
management.metrics.enable.jvm.threads=false
management.health.defaults.enabled=false
management.metrics.export.simple.enabled=true

# Disable Spring Boot Actuator metrics that use cgroups
management.metrics.binders.jvm.enabled=false
management.metrics.binders.system.enabled=false
management.metrics.binders.files.enabled=false
management.metrics.binders.processor.enabled=false
management.metrics.binders.uptime.enabled=false

# Set conservative connection pool settings
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=1

# Reduce Redis timeout to prevent hanging
spring.redis.timeout=2000ms
spring.redis.connect-timeout=2000ms

# Optimize for container memory constraints
spring.jpa.properties.hibernate.jdbc.batch_size=10
spring.jpa.properties.hibernate.default_batch_fetch_size=10 